<html>
	<head>
		<title>SKED</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"> 
		<link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
		<style>
			* {
				margin:  0;
    			padding: 0;
    			box-sizing: border-box;
                font-family: "soleil", 'Helvetica Neue', Helvetica, Arial;
			}
			body {
				background: rgba(105,210,231,1);
			}
			.page {
				width:100%;
				height:100%;
			}
			.header {
				width:100%;
    			height:50px;
    			background: rgba(105,210,231,1);
    			float: left;
    			position: relative;
    			border-bottom: 1px solid #EDEDED;
			}
			.headerLogo {
				height:40px;
				width:101.8px;
				margin: 5px auto 0 auto;
			}
			
			.headerLogo img {
				height: 100%;
				width:	100%;
			}

			/******* LOGIN PAGE *********/
			#loginPage {
				display: none;
				background: rgba(105,210,231,1);
			}
			#logoWrapper {
				width:168px;
				height:66px;
				margin: 40px auto 0 auto;
			}
			#logoWrapper img {
				height: 100%;
				width: 100%;
			}
			#loginFormWrapper {
				width:350px;
				margin: 20px auto 0 auto;
			}
			#loginForm {
				display: none;
			}
			#loginFormWrapper form span {
				color: hsl(5, 50%, 57%);
				display: block;
				height: 48px;
				line-height:48px;
				position: absolute;
				text-align: center;
				width: 36px;
			}
			#loginFormWrapper form input {
				font-size: 1em;
				line-height: 1.5em;
				-webkit-appearance:none;
				border: none;
				height: 48px;
				outline: none;
				width: 100%;
			}
			#loginFormWrapper form input[type='text'] {
				background-color:#fff;
				border-top: 2px solid #2c90c6;
				border-right: 1px solid #000;
				border-left: 1px solid #000;
				border-radius: 5px 5px 0 0;
				color:#363636;
				padding-left:36px;
			}
			#loginFormWrapper form input[type='password'] {
				background-color: #fff;
				border-top: 2px solid #2c90c6;
				border-right: 1px solid #000;
				border-bottom: 2px solid #2c90c6;
				border-left: 1px solid #000;
				border-radius: 0 0 5px 5px;
				color:#363636;
				margin-bottom: 20px;
				padding-left: 36px;
				
			}
			#loginFormWrapper form input[type='submit'] {
				background-color: #2c90c6;
				border: 1px solid #2c90c6;
				border-radius: 15px;
				color:#fff;
				font-weight: bold;
				line-height: 48px;
				text-align: center;
				text-transform: uppercase;
				margin-top: 25px;
				cursor: pointer;
				cursor: hand;
			}
			#loginFormWrapper form input[type='submit']:hover {
				background-color: #2c70c6;
				box-shadow: 2px 2px 20px #2c90c6 #fff 0 -1px 2px;

			}
			#loginFormWrapper button {
				background-color: #F5861E;
				border: 1px solid #2c90c6;
				border-radius: 15px;
				color:#fff;
				font-weight: bold;
				line-height: 48px;
				text-align: center;
				text-transform: uppercase;
				margin-top: 20px;
				font-size: 1em;
				line-height: 1.5em;
				-webkit-appearance:none;
				border: none;
				height: 48px;
				outline: none;
				width: 100%;
				cursor: pointer;
				cursor: hand;
			}	
			#loginFormWrapper button:hover {
				background:#CE7522;
				box-shadow: 2px 2px 20px #2c90c6 #fff 0 -1px 2px;

			}
			#loginError {
				position: absolute;
				margin-left: auto;
				margin-right: auto;
				left: 0;
				right: 0;
				width:350px;
				height: 20px;
				top:280px;
				font-size: 18px;
				text-align: center;
			}
			#gifLoader {
				display: none;
			}
			.spinner {
			  margin: 50px auto;
			  width: 80px;
			  height: 80px;
			  position: relative;
			}

			.container1 > div, .container2 > div, .container3 > div {
			  width: 24px;
			  height: 24px;
			  background-color: #333;

			  border-radius: 100%;
			  position: absolute;
			  -webkit-animation: bouncedelay 1.2s infinite ease-in-out;
			  animation: bouncedelay 1.2s infinite ease-in-out;
			  /* Prevent first frame from flickering when animation starts */
			  -webkit-animation-fill-mode: both;
			  animation-fill-mode: both;
			}

			.spinner .spinner-container {
			  position: absolute;
			  width: 100%;
			  height: 100%;
			}

			.container2 {
			  -webkit-transform: rotateZ(45deg);
			  transform: rotateZ(45deg);
			}

			.container3 {
			  -webkit-transform: rotateZ(90deg);
			  transform: rotateZ(90deg);
			}

			.circle1 { top: 0; left: 0; }
			.circle2 { top: 0; right: 0; }
			.circle3 { right: 0; bottom: 0; }
			.circle4 { left: 0; bottom: 0; }

			.container2 .circle1 {
			  -webkit-animation-delay: -1.1s;
			  animation-delay: -1.1s;
			}

			.container3 .circle1 {
			  -webkit-animation-delay: -1.0s;
			  animation-delay: -1.0s;
			}

			.container1 .circle2 {
			  -webkit-animation-delay: -0.9s;
			  animation-delay: -0.9s;
			}

			.container2 .circle2 {
			  -webkit-animation-delay: -0.8s;
			  animation-delay: -0.8s;
			}

			.container3 .circle2 {
			  -webkit-animation-delay: -0.7s;
			  animation-delay: -0.7s;
			}

			.container1 .circle3 {
			  -webkit-animation-delay: -0.6s;
			  animation-delay: -0.6s;
			}

			.container2 .circle3 {
			  -webkit-animation-delay: -0.5s;
			  animation-delay: -0.5s;
			}

			.container3 .circle3 {
			  -webkit-animation-delay: -0.4s;
			  animation-delay: -0.4s;
			}

			.container1 .circle4 {
			  -webkit-animation-delay: -0.3s;
			  animation-delay: -0.3s;
			}

			.container2 .circle4 {
			  -webkit-animation-delay: -0.2s;
			  animation-delay: -0.2s;
			}

			.container3 .circle4 {
			  -webkit-animation-delay: -0.1s;
			  animation-delay: -0.1s;
			}

			@-webkit-keyframes bouncedelay {
			  0%, 80%, 100% { -webkit-transform: scale(0.0) }
			  40% { -webkit-transform: scale(1.0) }
			}

			@keyframes bouncedelay {
			  0%, 80%, 100% { 
			    transform: scale(0.0);
			    -webkit-transform: scale(0.0);
			  } 40% { 
			    transform: scale(1.0);
			    -webkit-transform: scale(1.0);
			  }
			}
			/******* CONVERSATION PAGE *********/
			#conversationPage {
				display: none;
			}
			#conversations {

			}
		</style>
	</head>
	<body>
		<div class='page' id='loginPage'>
			<div id='logoWrapper'>
				<img src='/images/skedlogo.png'/>
			</div>
			<div id='loginFormWrapper'>
				<form id='signupForm' action='/signup'>
					<span class="fa fa-user"></span>
					<input type='text' id='signupName' name='name' placeholder="Full Name"/>

					<span class="fa fa-envelope"></span>
					<input type='text' id='signupEmail' name='email' placeholder="Email"/>

					<span class="fa fa-lock"></span>
					<input type='password' id='signupPassword' name='password'  placeholder="Password"/>

					<input type='submit' id='signupButton' value='Register' title='Register'/>
				</form>
				

				<form id='loginForm' action='/login'>
					<span class="fa fa-envelope"></span>
					<input type='text' id='loginEmail' name='email' placeholder="Email"/>

					<span class="fa fa-lock"></span>
					<input type='password' id='loginPassword' name='password'  placeholder="Password"/>

					<input type='submit' id='loginButton' value='Login' title='Login'/>
				</form>
				<div id='loginError'></div>
				<button id='changeForm'>Login</button>
				<div id='gifLoader'>
					<div class="spinner">
					  <div class="spinner-container container1">
					    <div class="circle1"></div>
					    <div class="circle2"></div>
					    <div class="circle3"></div>
					    <div class="circle4"></div>
					  </div>
					  <div class="spinner-container container2">
					    <div class="circle1"></div>
					    <div class="circle2"></div>
					    <div class="circle3"></div>
					    <div class="circle4"></div>
					  </div>
					  <div class="spinner-container container3">
					    <div class="circle1"></div>
					    <div class="circle2"></div>
					    <div class="circle3"></div>
					    <div class="circle4"></div>
					  </div>
					</div>
				</div>
			</div>
		</div>

		<div class='page' id='conversationPage'>
			<div class='header'>
				<div class='headerLogo'>
					<img src='/images/skedlogo.png'/>
				</div>
			</div>
			<div id='conversations'>
				<ul>

				</ul>
			</div>

		</div>

	</body>
	<script src='/js/jquery.min.js'></script>
	<script>
		/* PAGES */
		var loginPage 			= document.getElementById('loginPage');
		var conversationPage 	= document.getElementById('conversationPage');

		/* INIT */
		var loginSession = "";
		// DEVELOPMENT ONLY //
		// conversationPage.style.display = 'block';


		// disable forms from submitting
		$('form').submit(false);

		/* GLOBALS */
		thisDomain = "http://localhost:5000";

		/* REQUEST FUNCTIONS */
		function loginRequest() {
			var xhr = new XMLHttpRequest();
			xhr.open('POST', thisDomain + "/login", true);
			xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			xhr.onreadystatechange = function() {
				if(xhr.responseText === 1) {
					changeForm.style.display = 'none';
					loginButton.style.display = 'none';
					gifLoader.style.display = 'block';
				}
	        	if(xhr.readyState == 4) {
	        		gifLoader.style.display = 'none';
					changeForm.style.display = 'block';
					loginButton.style.display = 'block';
	        		console.log(xhr.responseText);
	        	}
        	}
        	var fd = new FormData();
	      	fd.append('email', loginEmail.value);
	      	fd.append('password', loginPassword.value);
	      	xhr.send(fd);
		}

		function signupRequest() {
			var xhr = new XMLHttpRequest();
			xhr.open('POST', thisDomain + "/signup", true);
			//xhr.setRequestHeader("Content-type", "application/x-www-form-encoded");
			xhr.onreadystatechange = function() {
				if(xhr.readyState === 1) {
					changeForm.style.display = 'none';
					signupButton.style.display = 'none';
					gifLoader.style.display = 'block';
				}
	        	if(xhr.readyState === 4) {
	        		gifLoader.style.display = 'none';
					changeForm.style.display = 'block';
					signupButton.style.display = 'block';
	        		console.log(xhr.responseText);
	        	}
        	}
        	var fd = new FormData();
        	fd.append('name', signupName.value);
	      	fd.append('email', signupEmail.value);
	      	fd.append('password', signupPassword.value);
	      	xhr.send(fd);
		}


		/* Login Page Logic */
		var loginFormState = "signup";
		var loginFormWrapper = document.getElementById('loginFormWrapper');
		var signupForm = document.getElementById('signupForm');
		var loginForm = document.getElementById('loginForm');
		var changeFormButton = document.getElementById('changeForm');
		var loginButton = document.getElementById('loginButton');

		var loginEmail = document.getElementById('loginEmail');
		var loginPassword = document.getElementById('loginPassword');

		var signupName = document.getElementById('signupName');
		var signupEmail = document.getElementById('signupEmail');
		var signupPassword = document.getElementById('signupPassword');
		var gifLoader = document.getElementById('gifLoader');
		var loginError = document.getElementById('loginError');

		changeFormButton.onclick = function() {
			if(loginFormState === "signup") {
				signupForm.style.display = 'none';
				loginForm.style.display = 'block';
				changeFormButton.textContent = "Signup";
				loginFormState = "login";
				loginFormWrapper.style.marginTop = '68px';
			}
			else {
				loginForm.style.display = 'none';
				signupForm.style.display = 'block';
				changeFormButton.textContent = "Login";
				loginFormState = "signup";
				loginFormWrapper.style.marginTop = '20px';
			}
		};

		signupButton.onclick = function() {
			if(signupName.value.length > 0 && signupEmail.value.length > 0 && signupPassword.value.length > 0) {
				signupRequest();
			}
			else {
				loginError.textContent = "All fields must be complete."
			}
			
		}

		loginButton.onclick = function() {
			if(loginEmail.value.length > 0 && loginPassword.value.length > 0) {
				
				loginRequest();
			}
			else {
				loginError.textContent = "All fields must be complete."
			}
		}

		/* Starting logic */
		var userObj = <%- userObj %>;
		console.log(userObj);
		if(!userObj) {
			loginPage.style.display = 'block';
		}
		else {

		}

		/* ACTIONS */
		

	 setTimeout(function() {
         // location.reload()
        }, 15000);
	</script>
</html>